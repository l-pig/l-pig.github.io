<!DOCTYPE html><html lang="en" data-astro-cid-46beyuii> <head><!-- favicon --><link rel="logo-192x192" sizes="180x180" href="/favicon/logo-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"><link rel="sitemap" href="/sitemap-index.xml"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/rss.xml"><meta name="theme-name" content="pages"><meta name="msapplication-TileColor" content="#000000"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v5.15.9"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>
      Golang GMP调度模型流程
 | L-Pig | L-Pig 的个人博客
    </title><meta name="description" content="Golang GMP调度模型流程
"><meta name="keywords" content="静态网站,静态网站系统,Maple_CMS,L-Pig"><meta property="og:title" content><meta property="og:description" content="Golang GMP调度模型流程
"><meta property="og:type" content="website"><meta property="og:url" content="https://blog.l-pig.cn/blog/gmp/"><meta property="og:image" content="https://blog.l-pig.cn/_astro/golang.BpeTWk16.png"><meta name="twitter:title" content><meta name="twitter:description" content="Golang GMP调度模型流程
"><meta name="twitter:image" content="https://blog.l-pig.cn/_astro/golang.BpeTWk16.png"><meta name="twitter:card" content="summary_large_image"><!-- DNS预连接和预取优化 --><!-- <link rel="preconnect" href="https://fontsapi.zeoseven.com" crossorigin /> --><!-- <link rel="preconnect" href="https://fontsapi-storage.zeoseven.com" crossorigin> --><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin><link rel="preconnect" href="https://hm.baidu.com" crossorigin><!-- 预取关键资源 --><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//fonts.gstatic.com"><!-- Katex --><link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous" referrerpolicy="no-referrer" onload="this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous" referrerpolicy="no-referrer"></noscript><!-- 预加载关键脚本 --><link rel="preload" as="script" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js" integrity="sha512-LQNxIMR5rXv7o+b1l8+N1EZMfhG7iFZ9HhnbJkTp4zjNr5Wvst75AqUeFDxeRUa7l5vEDyUiAip//r+EFLLCyA==" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js" integrity="sha512-LQNxIMR5rXv7o+b1l8+N1EZMfhG7iFZ9HhnbJkTp4zjNr5Wvst75AqUeFDxeRUa7l5vEDyUiAip//r+EFLLCyA==" crossorigin="anonymous" referrerpolicy="no-referrer" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js" integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin="anonymous" referrerpolicy="no-referrer" defer></script><script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.min.js" integrity="sha384-dZ/hSVfTPHuzXyECOYCetAvMd0cgqWxN5Fh+mwo86PV4GdU9xgQ/MNzh/YM/lotR" crossorigin="anonymous" defer></script><!-- https://docs.astro.build/en/guides/view-transitions --><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="swap"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.BMgXLWmZ.js"></script><script type="application/json" data-tooltips-options>{"interactive":false,"delay":[100,50],"data-astro-cid-46beyuii":true}</script><script type="module" src="/_astro/Tooltips.astro_astro_type_script_index_0_lang.Bx2cGmPu.js"></script><!-- Google Analytics - 仅在生产环境加载 --><script async src="https://www.googletagmanager.com/gtag/js?id=G-10TV4RDYEW"></script><script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-10TV4RDYEW');
        </script><!-- 百度统计 - 仅在生产环境加载 --><script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?943a020d15c994825fc7ced9a0370166";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script><meta name="baidu-site-verification" content="codeva-RmOcCYpW8H"><!-- 自定义头部代码 --><!-- 页面切换动画样式 --><!-- Supabase 已移除：不再加载全局客户端 --><link rel="stylesheet" href="/_astro/about.B0GeDM5q.css">
<link rel="stylesheet" href="/_astro/_entry_.e2I4x3N7.css">
<style>.drop-shadow-lg[data-astro-cid-oe3gw2as]{filter:drop-shadow(0 10px 8px rgb(0 0 0 / .04)) drop-shadow(0 4px 3px rgb(0 0 0 / .1))}
a[data-astro-cid-tibg2hfl]{text-decoration:none;color:inherit}a[data-astro-cid-tibg2hfl]:hover{text-decoration:none}.line-clamp-2[data-astro-cid-tibg2hfl]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
</style><script type="module" src="/_astro/page.CtpI7X2x.js"></script></head> <body data-astro-cid-46beyuii> <!-- SVG 滤镜定义 - 必须在使用前定义 --> <svg style="position: absolute; width: 0; height: 0; pointer-events: none;" data-astro-cid-46beyuii> <defs data-astro-cid-46beyuii> <filter id="glass-distortion" x="0%" y="0%" width="100%" height="100%" filterUnits="objectBoundingBox" data-astro-cid-46beyuii> <feTurbulence type="fractalNoise" baseFrequency="0.001 0.004" numOctaves="1" seed="17" result="turbulence" data-astro-cid-46beyuii></feTurbulence> <!-- Liked Seeds: 5, 14, 17 --> <feComponentTransfer in="turbulence" result="mapped" data-astro-cid-46beyuii> <feFuncR type="gamma" amplitude="1" exponent="10" offset="0.5" data-astro-cid-46beyuii></feFuncR> <feFuncG type="gamma" amplitude="0" exponent="1" offset="0" data-astro-cid-46beyuii></feFuncG> <feFuncB type="gamma" amplitude="0" exponent="1" offset="0.5" data-astro-cid-46beyuii></feFuncB> </feComponentTransfer> <feGaussianBlur in="turbulence" stdDeviation="3" result="softMap" data-astro-cid-46beyuii></feGaussianBlur> <feSpecularLighting in="softMap" surfaceScale="5" specularConstant="1" specularExponent="100" lighting-color="white" result="specLight" data-astro-cid-46beyuii> <fePointLight x="-200" y="-200" z="300" data-astro-cid-46beyuii></fePointLight> </feSpecularLighting> <feComposite in="specLight" operator="arithmetic" k1="0" k2="1" k3="1" k4="0" result="litImage" data-astro-cid-46beyuii></feComposite> <feDisplacementMap in="SourceGraphic" in2="softMap" scale="100" xChannelSelector="R" yChannelSelector="G" data-astro-cid-46beyuii></feDisplacementMap> </filter> </defs> </svg> <!-- 页面加载动画 --> <div class="page-loading" data-astro-cid-46beyuii> <div class="loading-container" data-astro-cid-46beyuii> <div class="loading-spinner" data-astro-cid-46beyuii></div> <div class="loading-text" id="loading-text" data-astro-cid-46beyuii>加载中...</div> <div class="loading-progress" data-astro-cid-46beyuii></div> </div> </div> <!-- Dual Image Background --> <header class="container px-3 lg:px-8 pb-6 z-30 lg:mt-4 lg:rounded-full sticky top-0" data-astro-cid-dt2qj6rv data-astro-transition-persist="astro-zg46k4mb-1"> <nav class="liquid-glass-container "><div class="liquidGlass-wrapper p-2.5 rounded-[35px] relative hover:bg-white/30 dark:bg-black/20 dark:hover:bg-black/50 !transition-colors duration-500 !delay-300"><div class="liquidGlass-effect rounded-[35px] intersect:animate-fadeDown transition-all duration-300 fast-slow"></div><div class="liquidGlass-tint rounded-[35px] intersect:animate-fadeDown transition-all duration-300 fast-slow"></div><div class="liquidGlass-shine rounded-[35px] intersect:animate-fadeDown transition-all duration-300 fast-slow"></div><div class="liquidGlass-text drop-shadow-md-white min-h-12 md:min-h-14 flex flex-wrap items-center justify-start relative intersect:animate-fadeDown transition-all duration-300 fast-slow">  <div class="order-0 flex ml-4 items-center" data-astro-cid-dt2qj6rv> <a href="/" class="flex items-center" data-astro-cid-dt2qj6rv> <img src="/favicon/logo.png" alt="L-Pig" eagerly-loaded="true" data-astro-cid-dt2qj6rv="true" loading="lazy" decoding="async" fetchpriority="auto" width="32" height="32" class="w-8 h-8 mx-1 rounded-full"> <span class="text-xl font-bold justify-center text-txt-p dark:text-darkmode-txt-p" data-astro-cid-dt2qj6rv> L-Pig </span> </a> </div>  <input id="nav-toggle" type="checkbox" class="hidden" data-astro-cid-dt2qj6rv> <label for="nav-toggle" class="order-2 cursor-pointer flex items-center md:hidden text-txt-p dark:text-darkmode-txt-p lg:order-1" data-astro-cid-dt2qj6rv> <svg id="show-button" class="h-5 mx-2 fill-current block" viewBox="0 0 20 20" data-astro-cid-dt2qj6rv> <title>Menu Open</title> <path d="M0 3h20v2H0V3z m0 6h20v2H0V9z m0 6h20v2H0V0z" data-astro-cid-dt2qj6rv></path> </svg> <svg id="hide-button" class="h-5 mx-2 fill-current hidden" viewBox="0 0 20 20" data-astro-cid-dt2qj6rv> <title>Menu Close</title> <polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)" data-astro-cid-dt2qj6rv></polygon> </svg> </label>  <ul id="nav-menu" class="bg-slate-100/90 md:bg-inherit rounded-lg text-center ml-8 order-3 hidden w-full p-4 md:order-1 md:flex md:w-auto md:space-x-1 md:p-0 lg:text-left lg:space-x-2" data-astro-cid-dt2qj6rv> <li class="relative group " data-astro-cid-dt2qj6rv> <a href="/" target="_self" class="flex items-center justify-center h-full my-4 md:my-0 border-none gap-2 px-1 font-bold text-txt-p transition-all duration-300 dark:text-darkmode-txt-p lg:px-2 rounded-xl relative z-10 hover:text-orange-600 dark:hover:text-orange-500 text-lg group-hover:text-orange-500 " data-astro-cid-dt2qj6rv> <button type="button" class="glass-button glass-button--menu glass-button--menu select-none nav-menu-btn text-txt-p dark:text-gray-100 w-full flex items-center gap-1 " data-astro-cid-dt2qj6rv="true" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: rgb(234, 88, 12);--variantHoverColor: rgb(249, 115, 22);--variantShadow: rgba(150, 150, 150, 0.6);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 1rem;--sizeFontSize: inherit;--sizeIconSize: 1.25rem;--sizeGap: inherit;--sizeBorderRadius: 37px;">   <span class="glass-button__content" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: rgb(234, 88, 12);--variantHoverColor: rgb(249, 115, 22);--variantShadow: rgba(150, 150, 150, 0.6);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 1rem;--sizeFontSize: inherit;--sizeIconSize: 1.25rem;--sizeGap: inherit;--sizeBorderRadius: 37px;"> 首页 </span>  </button>  </a>   </li><li class="relative group has-dropdown" data-astro-cid-dt2qj6rv> <a target="_self" class="flex items-center justify-center h-full my-4 md:my-0 border-none gap-2 px-1 font-bold text-txt-p transition-all duration-300 dark:text-darkmode-txt-p lg:px-2 rounded-xl relative z-10 hover:text-orange-600 dark:hover:text-orange-500 text-lg group-hover:text-orange-500 text-orange-500" data-astro-cid-dt2qj6rv> <button type="button" class="glass-button glass-button--menu glass-button--menu select-none nav-menu-btn is-active !text-orange-300 w-full flex items-center gap-1 " data-astro-cid-dt2qj6rv="true" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: rgb(234, 88, 12);--variantHoverColor: rgb(249, 115, 22);--variantShadow: rgba(150, 150, 150, 0.6);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 1rem;--sizeFontSize: inherit;--sizeIconSize: 1.25rem;--sizeGap: inherit;--sizeBorderRadius: 37px;">   <span class="glass-button__content" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: rgb(234, 88, 12);--variantHoverColor: rgb(249, 115, 22);--variantShadow: rgba(150, 150, 150, 0.6);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 1rem;--sizeFontSize: inherit;--sizeIconSize: 1.25rem;--sizeGap: inherit;--sizeBorderRadius: 37px;"> 文章<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="text-xs transition-transform duration-300 group-hover:rotate-180" data-astro-cid-dt2qj6rv="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="m112 184 144 144 144-144"></path></svg> </span>  </button>  </a>  <ul class="submenu absolute left-1/2 -translate-x-1/2 top-full pt-4 w-auto hidden group-hover:block transition-all duration-300 origin-top z-20" data-astro-cid-dt2qj6rv> <div class="glass rounded-xl p-2 flex flex-col md:flex-row gap-1 overflow-hidden whitespace-nowrap shadow-xl" data-astro-cid-dt2qj6rv> <li data-astro-cid-dt2qj6rv> <a href="/blog" class="block px-3 py-2 rounded-lg transition-colors text-sm text-center font-normal hover:bg-orange-100/50 dark:hover:bg-orange-500/20 text-txt-p dark:text-darkmode-txt-p" data-astro-cid-dt2qj6rv> <span class="mr-1" data-astro-cid-dt2qj6rv>📝</span> 博客 </a> </li><li data-astro-cid-dt2qj6rv> <a href="/notes" class="block px-3 py-2 rounded-lg transition-colors text-sm text-center font-normal hover:bg-orange-100/50 dark:hover:bg-orange-500/20 text-txt-p dark:text-darkmode-txt-p" data-astro-cid-dt2qj6rv> <span class="mr-1" data-astro-cid-dt2qj6rv>📢</span> 动态 </a> </li><li data-astro-cid-dt2qj6rv> <a href="/archives" class="block px-3 py-2 rounded-lg transition-colors text-sm text-center font-normal hover:bg-orange-100/50 dark:hover:bg-orange-500/20 text-txt-p dark:text-darkmode-txt-p" data-astro-cid-dt2qj6rv> <span class="mr-1" data-astro-cid-dt2qj6rv>🗂️</span> 归档 </a> </li> </div> </ul> </li><li class="relative group " data-astro-cid-dt2qj6rv> <a href="/links" target="_self" class="flex items-center justify-center h-full my-4 md:my-0 border-none gap-2 px-1 font-bold text-txt-p transition-all duration-300 dark:text-darkmode-txt-p lg:px-2 rounded-xl relative z-10 hover:text-orange-600 dark:hover:text-orange-500 text-lg group-hover:text-orange-500 " data-astro-cid-dt2qj6rv> <button type="button" class="glass-button glass-button--menu glass-button--menu select-none nav-menu-btn text-txt-p dark:text-gray-100 w-full flex items-center gap-1 " data-astro-cid-dt2qj6rv="true" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: rgb(234, 88, 12);--variantHoverColor: rgb(249, 115, 22);--variantShadow: rgba(150, 150, 150, 0.6);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 1rem;--sizeFontSize: inherit;--sizeIconSize: 1.25rem;--sizeGap: inherit;--sizeBorderRadius: 37px;">   <span class="glass-button__content" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: rgb(234, 88, 12);--variantHoverColor: rgb(249, 115, 22);--variantShadow: rgba(150, 150, 150, 0.6);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 1rem;--sizeFontSize: inherit;--sizeIconSize: 1.25rem;--sizeGap: inherit;--sizeBorderRadius: 37px;"> 朋友 </span>  </button>  </a>   </li><li class="relative group " data-astro-cid-dt2qj6rv> <a href="/about" target="_self" class="flex items-center justify-center h-full my-4 md:my-0 border-none gap-2 px-1 font-bold text-txt-p transition-all duration-300 dark:text-darkmode-txt-p lg:px-2 rounded-xl relative z-10 hover:text-orange-600 dark:hover:text-orange-500 text-lg group-hover:text-orange-500 " data-astro-cid-dt2qj6rv> <button type="button" class="glass-button glass-button--menu glass-button--menu select-none nav-menu-btn text-txt-p dark:text-gray-100 w-full flex items-center gap-1 " data-astro-cid-dt2qj6rv="true" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: rgb(234, 88, 12);--variantHoverColor: rgb(249, 115, 22);--variantShadow: rgba(150, 150, 150, 0.6);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 1rem;--sizeFontSize: inherit;--sizeIconSize: 1.25rem;--sizeGap: inherit;--sizeBorderRadius: 37px;">   <span class="glass-button__content" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: rgb(234, 88, 12);--variantHoverColor: rgb(249, 115, 22);--variantShadow: rgba(150, 150, 150, 0.6);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 1rem;--sizeFontSize: inherit;--sizeIconSize: 1.25rem;--sizeGap: inherit;--sizeBorderRadius: 37px;"> 关于 </span>  </button>  </a>   </li> </ul> <div class="order-1 ml-auto flex items-center md:order-2" data-astro-cid-dt2qj6rv> <a class="mr-4 inline-block border-border text-xl text-txt-p dark:border-darkmode-border dark:text-darkmode-txt-p" href="/search" aria-label="search" title="搜索" data-astro-cid-dt2qj6rv> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" data-astro-cid-dt2qj6rv="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M456.69 421.39 362.6 327.3a173.81 173.81 0 0 0 34.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 0 0 327.3 362.6l94.09 94.09a25 25 0 0 0 35.3-35.3zM97.92 222.72a124.8 124.8 0 1 1 124.8 124.8 124.95 124.95 0 0 1-124.8-124.8z"></path></svg> </a> <!-- 随机文章按钮 --> <button id="random-article-btn" class="mr-4 p-2 text-orange-400 hover:text-orange-500 dark:text-orange-500 dark:hover:text-orange-400 transition-colors group" title="随机文章" data-astro-cid-dt2qj6rv> <svg class="w-5 h-5 transition-transform duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-dt2qj6rv> <path fill="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 4v3.5a.3.3 0 0 1-.3.3H16a.3.3 0 0 1-.212-.512l1.147-1.146A8 8 0 0 0 4.34 8.54a.6.6 0 0 1-1.159-.308A10 10 0 0 1 18.207 4.54l1.147-1.146A.3.3 0 0 1 20 4zm-16 16v-3.5a.3.3 0 0 1 .3-.3H8a.3.3 0 0 1 .212.512L7.207 18A8 8 0 0 0 19.66 15.46a.6.6 0 0 1 1.159.308A10 10 0 0 1 5.793 19.46l-1.147 1.146A.3.3 0 0 1 4 20z" data-astro-cid-dt2qj6rv></path> </svg> </button> <div class="inline-flex a mr-2"> <input class="absolute opacity-0" id="theme-switcher" data-theme-switcher type="checkbox"> <label class="relative inline-block h-4 w-6 cursor-pointer" for="theme-switcher"> <span class="sr-only">theme switcher</span> <a class="absolute -top-1 left-0 flex h-6 w-6 items-center justify-center rounded-full" title="切换主题"> <svg class="absolute z-10 opacity-100 dark:opacity-0" viewBox="0 0 24 24" height="21" width="21"> <path fill="#000" d="M20.742 13.045a8.088 8.088 0 0 1-2.077.271c-2.135 0-4.14-.83-5.646-2.336a8.025 8.025 0 0 1-2.064-7.723A1 1 0 0 0 9.73 2.034a10.014 10.014 0 0 0-4.489 2.582c-3.898 3.898-3.898 10.243 0 14.143a9.937 9.937 0 0 0 7.072 2.93 9.93 9.93 0 0 0 7.07-2.929 10.007 10.007 0 0 0 2.583-4.491 1.001 1.001 0 0 0-1.224-1.224zm-2.772 4.301a7.947 7.947 0 0 1-5.656 2.343 7.953 7.953 0 0 1-5.658-2.344c-3.118-3.119-3.118-8.195 0-11.314a7.923 7.923 0 0 1 2.06-1.483 10.027 10.027 0 0 0 2.89 7.848 9.972 9.972 0 0 0 7.848 2.891 8.036 8.036 0 0 1-1.484 2.059z"></path> </svg> <svg class="absolute z-10 opacity-0 dark:opacity-100" viewBox="0 0 24 24" height="21" width="21"> <path fill="#fff" d="M6.993 12c0 2.761 2.246 5.007 5.007 5.007s5.007-2.246 5.007-5.007S14.761 6.993 12 6.993 6.993 9.239 6.993 12zM12 8.993c1.658 0 3.007 1.349 3.007 3.007S13.658 15.007 12 15.007 8.993 13.658 8.993 12 10.342 8.993 12 8.993zM10.998 19h2v3h-2zm0-17h2v3h-2zm-9 9h3v2h-3zm17 0h3v2h-3zM4.219 18.363l2.12-2.122 1.415 1.414-2.12 2.122zM16.24 6.344l2.122-2.122 1.414 1.414-2.122 2.122zM6.342 7.759 4.22 5.637l1.415-1.414 2.12 2.122zm13.434 10.605-1.414 1.414-2.122-2.122 1.414-1.414z"></path> </svg> </a> </label> </div> <script data-astro-rerun>
  const defaultTheme = "system";

  function getTheme(defaultTheme) {
    var darkMode = defaultTheme === "dark" ? true : false;
    if (localStorage.getItem("theme") === "system") {
      if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
        darkMode = true;
      }
    } else if (localStorage.getItem("theme") === "dark") {
      darkMode = true;
    } else if (localStorage.getItem("theme") === "light") {
      darkMode = false;
    }
    return darkMode;
  }

  function setTheme(darkMode) {
    // Update DOM
    darkMode
      ? document.documentElement.classList.add("dark")
      : document.documentElement.classList.remove("dark");
    // Update localStorage
    localStorage.setItem("theme", darkMode ? "dark" : "light");
  }

  // This prevents flickering back to default theme before the page is fully loaded
  setTheme(getTheme(defaultTheme));

  document.addEventListener("astro:page-load", () => {
    setTheme(getTheme(defaultTheme));
    // Theme switcher
    var themeSwitch = document.querySelectorAll("[data-theme-switcher]");
    themeSwitch.forEach((el) => {
      el.addEventListener("change", (e) => {
        setTheme(e.target.checked);
      });
    });
  });
</script> </div>   </div></div></nav>  <script type="module">document.addEventListener("astro:page-load",()=>{u()});function u(){const t=window.location.pathname,e=t.endsWith("/")&&t.length>1?t.slice(0,-1):t;document.querySelectorAll("#nav-menu > li").forEach(s=>{const n=s.querySelector("a"),a=n?.querySelector(".nav-menu-btn");if(!n||!a)return;const o=n.getAttribute("href")||"";let i=!1;(o==="/"&&e==="/"||o&&o!=="/"&&e.startsWith(o))&&(i=!0),s.querySelectorAll(".submenu a").forEach(r=>{const c=r.getAttribute("href")||"",l=c.endsWith("/")&&c.length>1?c.slice(0,-1):c;l&&l!==""&&l===e?(i=!0,r.classList.add("text-orange-500","bg-orange-50","dark:bg-orange-500/10"),r.classList.remove("text-txt-p","dark:text-darkmode-txt-p")):(r.classList.remove("text-orange-500","bg-orange-50","dark:bg-orange-500/10"),r.classList.add("text-txt-p","dark:text-darkmode-txt-p"))}),i?(n.classList.add("text-orange-500"),a.classList.add("is-active","!text-orange-300")):(n.classList.remove("text-orange-500"),a.classList.remove("is-active","!text-orange-300"))})}document.addEventListener("astro:page-load",function(){const t=document.getElementById("nav-toggle"),e=document.getElementById("nav-menu");t&&e&&t.addEventListener("change",function(){this.checked?(e.classList.remove("hidden"),e.classList.add("show")):(e.classList.add("hidden"),e.classList.remove("show"))}),document.querySelectorAll("#nav-menu a").forEach(s=>{s.addEventListener("click",function(){t&&e&&(t.checked=!1,e.classList.add("hidden"),e.classList.remove("show"))})})});document.addEventListener("astro:page-load",function(){const t=document.getElementById("random-article-btn");t&&t.addEventListener("click",async function(){const e=this,d=e.innerHTML;try{e.disabled=!0,e.innerHTML='<svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>';const s=await fetch("/api/blog-articles.json");if(!s.ok)throw new Error("无法获取文章列表");const n=await s.json();if(!n||n.length===0)throw new Error("没有找到可用的文章");const a=Math.floor(Math.random()*n.length),o=n[a];window.location.href=`/blog/${o.slug}`}catch(s){console.error("获取随机文章失败:",s),e.disabled=!1,e.innerHTML=d,alert("获取随机文章失败，请稍后重试")}})});u();</script> </header> <main id="main-content" class="flex-1 pb-16 md:pb-36" data-astro-cid-46beyuii>   <section class="flex container px-3 lg:px-8"> <div class="w-full lg:w-3/4 xl:w-4/5"> <article> <section> <div class=""> <div class="liquid-glass-container "><div class="liquidGlass-wrapper dock mb-4 !p-0 overflow-hidden"><div class="liquidGlass-effect-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-tint-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-shine  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-text  intersect:animate-fadeUp transition-all duration-300 fast-slow"><div class="absolute inset-0"> <img src="/_astro/golang.BpeTWk16_Z14O7mF.webp" alt loading="eager" decoding="async" fetchpriority="auto" width="1200" height="280" class="w-full h-full object-cover rounded-[35px]">  <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-black/10 to-black/0"></div> </div><div class="relative z-10 p-6 min-h-[280px] flex flex-col justify-end"> <div class="text-white"> <h1 class="mb-4 text-white drop-shadow-lg text-shadow-lg text-xl md:text-3xl font-bold">Golang GMP调度模型流程</h1> <ul class="flex flex-wrap gap-4 text-sm text-white/90">  <li class="flex items-center gap-1" title="创建日期"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="text-base" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"></path></svg> <span>2026-01-08</span> </li>    <li class="flex items-center gap-2" title="分类"> <a href="/blog/categories/golang" class="flex items-center gap-1 hover:text-primary transition-colors"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="text-base" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"></path></svg> <span>Golang</span> </a> </li> <li class="flex items-center gap-2" title="标签"> <a href="/blog/tags/golang" class="flex items-center gap-1 hover:text-primary transition-colors"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="text-base" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"></path></svg> <span>golang</span> </a><a href="/blog/tags/枚举" class="flex items-center gap-1 hover:text-primary transition-colors"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="text-base" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"></path></svg> <span>枚举</span> </a> </li>  </ul> </div> </div> </div></div></div> </div> </section> <section class="liquid-glass-container "><div class="liquidGlass-wrapper panel flex flex-col justify-between mb-4 rounded-[35px] intersect-no-queue min-h-96"><div class="liquidGlass-effect-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-tint-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-shine  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-text  intersect:animate-fadeUp transition-all duration-300 fast-slow"> <div class="p-3 lg:p-8 prose max-w-none markdown-content text-txt-p dark:text-darkmode-txt-p intersect:animate-fadeUp">  <h2 id="一什么是gmp">一、什么是GMP?</h2>
<blockquote>
<p>GMP 是 Go 语言的调度模型，是 Go 语言的并发模型。</p>
</blockquote>
<p><img src="/assets/uploads/gmp-model.png" alt="gmp-model.png"></p>
<p>源码：<a href="https://github.com/golang/go/blob/master/src/runtime/runtime2.go" rel="nofollow noopener noreferrer" target="_blank">GMP</a></p>
<h2 id="二gmp-模型">二、GMP 模型</h2>
<blockquote>
<p>GMP 模型 是 Go 语言调度器的核心模型，它是 Go 语言调度器的基础。</p>
</blockquote>





















<table><thead><tr><th>组件</th><th>说明</th></tr></thead><tbody><tr><td>G(Goroutine)</td><td>调度的基本单位，由Go的运行时管理，比OS线程更轻量的协程，包含栈和相关上下文的信息，在Golang中 使用 <code>go</code> 开启一个协程</td></tr><tr><td>M(Machine)</td><td>代表一个执行线程或系统线程，是真正工作的单位，M中保存自身使用的栈信息、当前M正在执行的G的信息与其绑定的P的信息</td></tr><tr><td>P(Processor)</td><td>代表一个逻辑处理器，维护了一个处于可运行状态的G队列，每一个M都有一个P对应关联，P的数量是固定的，由GOMAXPROCS决定，默认为CPU核数</td></tr></tbody></table>
<ul>
<li><strong>本地运行队列（Local Runnable Queue，LRQ）</strong>：存放当前 P 的 G，每个 P 都有一个本地队列， 用于存放当前 P 等待和正在运行的
G，每个 P 的本地队列中最多存放 256 个 G 。创建 G 时，会优先放入本地队列，如果本地队列满了，则会将队列中一半的 G 移动到全局队列中。</li>
<li><strong>全局运行队列（Global Runnable Queue，GRQ）</strong>：存放正在等待的 G，即没有在LRQ中的 G，</li>
<li><strong>M 的数量是动态的，由调度器决定</strong>。根据当前系统的负载自动调整，M 像运行任务，就需要获取 P ，如何没有 P 那 M 就会阻塞。如果
P 的本地队列为空，M 就会从全局队列中获取 G 放入本地队列，如果全局队列也为空，M 就会从其他随机一个 P 的本地队列中获取一半的
G 放到当前 P 的本地队列中。</li>
</ul>
<h2 id="三gmp-各自的特点">三、G、M、P 各自的特点：</h2>
<h3 id="ggoroutine">G(Goroutine)</h3>
<ul>
<li>当 goroutine 被调离 CPU 时，调度器负责把 CPU 寄存器的值保存在 g 对象的成员变量之中。 当 goroutine 被调度起来运行时，调度器又负责把
g 对象的成员变量所保存的寄存器值恢复到 CPU 的寄存器。</li>
</ul>
<h3 id="mmachine">M(Machine)</h3>
<ul>
<li>
<p>设置M的数量</p>
<ul>
<li>runtime/debug 中的 SetMaxThreads 函数，设置 M 的最大数量</li>
</ul>
</li>
<li>
<p>M:N模型</p>
<ul>
<li>
<p>M 个 goroutines (G) 被调度到 N 个内核线程 (M) 上执行，这些线程运行在最多 <code>GOMAXPROCS</code> 个逻辑处理器 (P) 上。</p>
</li>
<li>
<p>P 负责管理 G 的本地运行队列（<em>LRQ</em>），每个 P 必须绑定一个 M 才能执行 G。如果某个 M 阻塞（如系统调用），与该 M 绑定的 P
会解绑，并由其他空闲的 M（或新建的 M）接管这个 P，继续执行其 LRQ 中的 G。</p>
</li>
</ul>
</li>
<li>
<p>M阻塞和G阻塞的区别</p>



































<table><thead><tr><th>维度</th><th>M 阻塞（线程级）</th><th>G 阻塞（协程级）</th></tr></thead><tbody><tr><td>触发原因</td><td>系统调用、CGO 等底层操作</td><td>Channel、锁、Gosched() 等用户态操作</td></tr><tr><td>阻塞对象</td><td>内核线程（M）</td><td>Goroutine（G）</td></tr><tr><td>调度影响</td><td>P 与 M 解绑，可能创建新 M</td><td>G 被移出运行队列，M 执行其他 G</td></tr><tr><td>恢复机制</td><td>系统调用完成后重新绑定 P</td><td>条件满足后重新加入运行队列</td></tr><tr><td>性能代价</td><td>高（线程切换、内核态开销）</td><td>低（用户态调度，无线程切换）</td></tr></tbody></table>
</li>
<li>
<p>M 的自旋状态</p>
<blockquote>
<p>自旋（<strong>Spinning</strong>） 是指 M 在暂时没有可执行的 G（<strong>Goroutine</strong>）时，不立即进入休眠，而是空转循环（忙等待），主动寻找可运行的
G。 自旋的 M 会占用 CPU 资源，但避免了线程休眠和重新唤醒的代价（系统调用、上下文切换等）。</p>
</blockquote>
<p>一个 M 进入自旋状态通常需要满足以下条件：</p>
<ul>
<li>当前 M 绑定的 P 的本地运行队列（LRQ）为空，且无法立即从全局队列（GRQ）或其他 P 偷取到 G。</li>
<li>仍有其他 P 正在运行 G（即系统整体有任务可执行，只是当前 P 暂时无任务）。</li>
<li>自旋的 M 数量未超过阈值（默认最多 GOMAXPROCS/2 个自旋 M，防止过度占用 CPU）。</li>
</ul>
<p>自旋的 M 会持续执行以下操作：</p>
<ul>
<li>检查全局队列（GRQ）：</li>
<li>定期扫描 GRQ，看是否有新加入的 G 可执行。</li>
<li>尝试从其他 P 偷取 G（Work Stealing）：</li>
<li>随机选择其他 P，从其 LRQ 中偷取一半的 G（最少偷 1 个）。</li>
<li>检查网络轮询器（Netpoller）： 查看是否有就绪的网络 I/O 相关的 G 可恢复执行。</li>
<li>自旋超时后休眠： 如果自旋一段时间（约 10ms）仍找不到 G，M 会退出自旋状态并休眠。</li>
</ul>
</li>
</ul>
<h3 id="pprocessor">P(Processor)</h3>
<ul>
<li>当一个线程阻塞的时候，将和它绑定的 P 上的 G 转移到其他线程。Go scheduler 会启动一个后台线程 sysmon，用来检测长时间（超过
10 ms）运行的 goroutine，将其调度到 global runqueues。这是一个全局的 runqueue，优先级比较低，以示惩罚。</li>
<li>设置P的数量
<ul>
<li>P 的数量是固定的，由启动时环境变量 <code>GOMAXPROCS</code> 或者是由 <code>runtime</code> 的方法 <code>GOMAXPROCS()</code> 决定。这意味着在程序执行的任意时刻都只有
<code>GOMAXPROCS</code> 个 goroutine 在同时运行。</li>
</ul>
</li>
</ul>
<h3 id="p-和-m-的创建时机">P 和 M 的创建时机。</h3>
<ul>
<li>P 在系统启动根据<code>GOMAXPROCES</code> 创建 n 个 P。</li>
<li>M 在 没有足够的 M 来关联 P 并运行其中可运行的 G 时，例如：M 在阻塞状态，但是 P 中还有空闲任务，就会去寻找空闲的 M ，如果没有空闲的
M，就会创建新的 M。</li>
</ul>
<h2 id="四gmp调度流程">四、GMP调度流程</h2>
<h3 id="什么是go的调度器">什么是Go的调度器？</h3>
<p><img src="/assets/uploads/go-scheduler.png" alt="go-scheduler.png"></p>
<p>源码：<a href="https://github.com/golang/go/blob/master/src/runtime/proc.go" rel="nofollow noopener noreferrer" target="_blank">proc.go</a></p>
<ul>
<li>Go scheduler 是 Go runtime 的一部分，它内嵌在 Go 程序里，和 Go 程序一起运行。因此它运行在用户空间，在 kernel 的上一层。</li>
<li>程序运行时会启动一些 G：垃圾回收的 G，执行调度的 G，运行用户代码的 G (<strong>main</strong> 也是一个 G )；并且会创建一个 M 用来开始 G
的运行。随着时间的推移，更多的 G 会被创建出来，更多的 M 也会被创建出来。</li>
</ul>
<h3 id="调度器的设计策略">调度器的设计策略</h3>
<ul>
<li><strong>复用线程</strong>：避免频繁的创建、销毁线程。</li>
<li><strong>work stealing机制(盗用机制)</strong>：当本地运行队列为空时，尝试从其他 P 的运行队列偷取 G，而不是直接销毁线程 (M)。</li>
<li><strong>hand off 机制(交接机制)</strong>：当本线程因为 G 进行系统调用阻塞时，线程释放绑定的 P，把 P 转移给其他空闲的线程执行。</li>
<li><strong>并行</strong>：通过设置 <code>GOMAXPROCS</code> 配置 P 的数量，从而达到并行的目的，当 P 达到CPU核心数时，达到最大的并行度。</li>
<li><strong>抢占式调度</strong>：在 coroutine 中，需要等待一个协程主动让出CPU才能执行下一个协程，Go规定每个 goroutine 只会持有CPU
10ms，防止其他协程被饿死。</li>
</ul>
<h3 id="调度器的生命周期">调度器的生命周期</h3>
<p><img src="/assets/uploads/go-schedule-life.png" alt="go-schedule-life.png"></p>
<h4 id="m0-和-g0">M0 和 G0</h4>
<ul>
<li>M0 是 程序启动后编号为0的主线程，这个 M 对应的实例会在全局变量 runtime.m0(定义在 proc.go 的 m0) 中，M0 负责执行初始化操作和启动第一个
G。</li>
<li>G0 是每次启动一个 M 都会第一个创建的 gourtine，G0 仅用于负责调度的 G，G0 不指向任何可执行的函数，每个 M 都会有一个自己的
G0。在调度或系统调用时会使用 G0 的栈空间，全局变量的 G0 (proc.go 的 g0) 是 M0 的 G0。</li>
</ul>
<h3 id="go-func-的调度流程">go func() 的调度流程</h3>
<p><img src="/assets/uploads/gofunc-workflow.png" alt="gofunc-workflow.png"></p>
<ul>
<li>编译器将<code>go func()</code> 转换成对 <code>runtime.newproc</code> 的调用(在runtime/proc.go 中)。</li>
<li><strong>newproc</strong> : 切换到 g0 栈调用 <code>newproc1</code>。</li>
<li><strong>newproc1</strong> :
<ul>
<li>从 <code>p.gfree</code> 中 获取一个空闲的g，如果没有就从全局队列中获取一批(proc.go 的 <code>gfget</code> 函数)。</li>
<li>初始化 G 的栈和上下文（SP, PC）。这里将 PC 设置为了 <code>goexit</code>，以便 G 跑完后能自动退出。</li>
</ul>
</li>
<li>调用 <code>runqput</code> 将新 G 放入当前 P 的本地队列。如果满了，则放入全局队列。</li>
<li>尝试再加一个P来执行G。当 G 可运行（newproc、ready）时调用(proc.go 的 wakep 函数)</li>
</ul>
<h3 id="代码演示">代码演示</h3>
<pre class="astro-code astro-code-themes github-light github-dark-dimmed" style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7; overflow-x: auto;" tabindex="0" data-language="go"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F47067">package</span><span style="color:#6F42C1;--shiki-dark:#F69D50"> main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F47067">import</span><span style="color:#032F62;--shiki-dark:#96D0FF"> "</span><span style="color:#6F42C1;--shiki-dark:#F69D50">fmt</span><span style="color:#032F62;--shiki-dark:#96D0FF">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F47067">func</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB"> main</span><span style="color:#24292E;--shiki-dark:#ADBAC7">() {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ADBAC7">    fmt.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB">Println</span><span style="color:#24292E;--shiki-dark:#ADBAC7">(</span><span style="color:#032F62;--shiki-dark:#96D0FF">"Hello world"</span><span style="color:#24292E;--shiki-dark:#ADBAC7">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ADBAC7">}</span></span></code></pre>
<ol>
<li>runtime 创建最初的线程 m0 和 goroutine g0，并把 2 者关联。</li>
<li>调度器初始化：初始化 m0、栈、垃圾回收，以及创建和初始化由 <code>GOMAXPROCS</code> 个 P 构成的 P 列表。</li>
<li>示例代码中的 main 函数是 <code>main.main</code>，<code>runtime</code> 中也有 1 个 main 函数 —— <code>runtime.main</code>，代码经过编译后，<code>runtime.main</code> 会调用 <code>main.main</code>，程序启动时会为 <code>runtime.main</code> 创建 goroutine，称它为 main goroutine 吧，然后把 main goroutine 加入到 P 的本地队列。</li>
<li>启动 m0，m0 已经绑定了 P，会从 P 的本地队列获取 G，获取到 main goroutine。</li>
<li>G 拥有栈，M 根据 G 中的栈信息和调度信息设置运行环境。</li>
<li>M 运行 G。</li>
<li>G 退出，再次回到 M 获取可运行的 G，这样重复下去，直到 <code>main.main</code> 退出，<code>runtime.main</code> 执行 Defer 和 Panic 处理，或调用 <code>runtime.exit</code> 退出程序。</li>
</ol>
<p><strong>感兴趣可以追踪一下 runtime.main()</strong></p>
<h3 id="调度循环">调度循环</h3>
<blockquote>
<p>Go 调度器的核心逻辑几乎全都在 <strong><code>src/runtime/proc.go</code></strong> 文件中。</p>
</blockquote>
<p><strong><code>schedule</code></strong> 函数，它是整个调度器的核心。</p>
<p>大致流程如下：</p>
<ol>
<li><strong>检查全局队列</strong>：为了公平，每隔 61 次调度，会去全局队列（<code>sched.runq</code>）拿一个 G。</li>
<li><strong>检查本地队列</strong>：调用 <code>runqget()</code> 从当前 P 的本地队列获取 G。</li>
<li><strong>工作窃取 (Work Stealing)</strong>：如果本地没有，调用 <code>findrunnable()</code>。这个函数极其复杂，它会尝试从全局队列拿、从网络轮询器（Netpoller）拿、或者从其他 P 的队列里“偷”一半 G 过来。</li>
<li><strong>执行</strong>：找到 G 后，调用 <code>execute(g, inheritTime)</code>。</li>
</ol>
<h3 id="上下文切换">上下文切换</h3>
<p>Go 如何从“调度逻辑”切换到“用户代码”？
根据架构不同，go 提供了不同的汇编源码，以 <code>asm_amd64.s</code> 为例</p>
<p><strong>gogo 函数</strong></p>
<ul>
<li>在 <code>proc.go</code> 的 <code>execute()</code> 函数最后，会调用 <code>gogo(&#x26;g.sched)</code>。<code>gogo</code> 是一个汇编函数。</li>
<li>它利用 <code>g.sched</code> 中保存的信息，恢复寄存器（RSP, RIP 等）。</li>
<li>最后一条指令是 <code>JMP</code>(arm 的跳转指令是 B ，代表无条件跳转，B. 代表有条件跳转)，直接跳到用户代码的位置。至此，由 G 开始执行。</li>
<li>当 G 需要让出 CPU（比如调用了 <code>time.Sleep</code> 或 阻塞在 Channel 上）时，不能直接切过去，必须先切回 <code>g0</code>。</li>
</ul>
<p><strong>mcall 函数</strong></p>
<ul>
<li><code>mcall(fn)</code> 也是汇编实现。</li>
<li>它保存当前 G 的上下文到 <code>g.sched</code>。</li>
<li><strong>切换栈指针 (SP)</strong> 到 <code>g0</code> 的栈。</li>
<li>在 <code>g0</code> 栈上执行回调函数 <code>fn</code>（例如 <code>park_m</code>），最终再次调用 <code>schedule()</code> 进行下一轮调度。</li>
</ul>
<br>
<br>
<br>
<h1 id="参考">参考</h1>
<p><a href="https://www.topgoer.com/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/GMP%E5%8E%9F%E7%90%86%E4%B8%8E%E8%B0%83%E5%BA%A6.html" rel="nofollow noopener noreferrer" target="_blank">GMP 原理与调度</a></p>  </div> </div></div></section> <!-- 文章信息区 --> <!-- 文章底部信息卡片 --> <div class="relative mt-16"> <!-- 作者头像 - 超出顶部 --> <div class="left_centor -top-12 transform -translate-x-1/2 z-10 animate-fadeUp"> <div class="relative group"> <div class="absolute -inset-2 bg-gradient-to-r from-orange-500 via-indigo-500 to-green-500 rounded-[35px] blur opacity-40 group-hover:opacity-60 transition duration-300"></div> <img src="/_astro/picture.Cm-b1VQQ_Z1d7foG.webp" alt="L-Pig" loading="lazy" decoding="async" fetchpriority="auto" width="80" height="80" class="relative w-20 h-20 rounded-full border-4 border-white/50 shadow-2xl transform group-hover:scale-105 transition-all duration-300 bg-white/10 backdrop-blur-sm"> </div> </div> <div class="liquid-glass-container "><div class="liquidGlass-wrapper dock rounded-2xl pt-16 pb-8 px-8"><div class="liquidGlass-effect-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-tint-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-shine  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-text intersect-no-queue intersect:animate-fadeUp transition-all duration-300 fast-slow">  <div class="text-center m-6"> <div class="font-bold text-2xl text-txt-p dark:text-darkmode-txt-p mb-1"> L-Pig </div> <!-- <div class="text-sm text-txt-s dark:text-darkmode-txt-s opacity-80">
                文章作者
              </div> --> </div>  <div class="flex items-center justify-center gap-4 mb-2"> <button id="share-btn" type="button" class="glass-button glass-button--secondary glass-button--md select-none min-w-24 justify-center " title="分享" data-astro-cid-qerq4hxv="true" data-astro-cid-xwnkcw7l style="--variantBase: rgba(59, 130, 246, 0.25);--variantHover: rgba(59, 130, 246, 0.35);--variantBorder: rgba(71, 158, 255, 0.4);--variantHoverBorder: rgba(73, 158, 254, 0.6);--variantColor: #2563eb;--variantHoverColor: #3b82f6;--variantShadow: rgba(37, 99, 235, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.75rem 1rem;--sizeFontSize: 1rem;--sizeIconSize: 1rem;--sizeGap: 0.5rem;--sizeBorderRadius: 999px;">  <span class="glass-button__icon" data-astro-cid-xwnkcw7l style="--variantBase: rgba(59, 130, 246, 0.25);--variantHover: rgba(59, 130, 246, 0.35);--variantBorder: rgba(71, 158, 255, 0.4);--variantHoverBorder: rgba(73, 158, 254, 0.6);--variantColor: #2563eb;--variantHoverColor: #3b82f6;--variantShadow: rgba(37, 99, 235, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.75rem 1rem;--sizeFontSize: 1rem;--sizeIconSize: 1rem;--sizeGap: 0.5rem;--sizeBorderRadius: 999px;"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
</svg></span> <span class="glass-button__content" data-astro-cid-xwnkcw7l style="--variantBase: rgba(59, 130, 246, 0.25);--variantHover: rgba(59, 130, 246, 0.35);--variantBorder: rgba(71, 158, 255, 0.4);--variantHoverBorder: rgba(73, 158, 254, 0.6);--variantColor: #2563eb;--variantHoverColor: #3b82f6;--variantShadow: rgba(37, 99, 235, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.75rem 1rem;--sizeFontSize: 1rem;--sizeIconSize: 1rem;--sizeGap: 0.5rem;--sizeBorderRadius: 999px;"> 
分享
 </span>  </button>  <!-- 提示消息 --> <div id="share-toast" class="share-toast hidden" data-astro-cid-qerq4hxv>链接已复制到剪贴板！</div>  <script type="module">const shareUrl = "https://blog.l-pig.cn/blog/gmp";
const title = "Golang GMP调度模型流程";

  const shareBtn = document.getElementById("share-btn");
  const shareToast = document.getElementById("share-toast");

  // 复制到剪贴板函数
  async function copyToClipboard(text) {
    try {
      if (navigator.clipboard && window.isSecureContext) {
        await navigator.clipboard.writeText(text);
        return true;
      } else {
        // 降级方案
        const textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.position = "fixed";
        textArea.style.left = "-999999px";
        textArea.style.top = "-999999px";
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        const result = document.execCommand("copy");
        textArea.remove();
        return result;
      }
    } catch (err) {
      console.error("复制失败:", err);
      return false;
    }
  }

  // 显示提示消息
  function showToast() {
    shareToast.classList.remove("hidden", "hide");
    shareToast.classList.add("show");

    setTimeout(() => {
      shareToast.classList.add("hide");
      setTimeout(() => {
        shareToast.classList.add("hidden");
        shareToast.classList.remove("show", "hide");
      }, 300);
    }, 2000);
  }

  // 分享按钮点击事件
  shareBtn.addEventListener("click", async () => {
    if (shareBtn.disabled) return;

    shareBtn.disabled = true;

    try {
      const success = await copyToClipboard(shareUrl);
      if (success) {
        showToast();
      } else {
        console.error("复制链接失败");
      }
    } catch (error) {
      console.error("分享操作失败:", error);
    } finally {
      shareBtn.disabled = false;
    }
  });

  // 初始化函数
  function init() {
    // 分享按钮初始化完成
  }

  // Astro 页面导航事件监听
  document.addEventListener("astro:page-load", init);

  // 兼容首次加载和传统页面跳转
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", init);
  } else {
    // 立即执行初始化
    init();
  }
</script> </div>  <div class="w-full h-px bg-gradient-to-r from-transparent via-white/20 to-transparent mb-2"></div>  <div class="space-y-4 text-center"> <!-- 版权信息 --> <div class="text-xs text-txt-p dark:text-darkmode-txt-p opacity-75 leading-relaxed"> <div class="flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-4"> <span>
© 2025 by
<a href="https://blog.l-pig.cn">L-Pig</a>
本文基于
<a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="font-bold">
CC BY-NC-SA 4.0
</a>
许可
<img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt="CC 协议" aria-label="CC 协议" style="max-width: 1em;max-height:1em; display:inline-block;"> <img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt="必须注明创作者" style="max-width: 1em;max-height:1em;display:inline-block;"> <img src="https://mirrors.creativecommons.org/presskit/icons/nc.svg" alt="仅允许将作品用于非商业用途" style="max-width: 1em;max-height:1em;display:inline-block;"> <img src="https://mirrors.creativecommons.org/presskit/icons/sa.svg" alt="改编作品必须遵循相同条款进行共享" style="max-width: 1em;max-height:1em;display:inline-block;"> </span> <span class="hidden sm:inline text-white/30">|</span> <span class="inline-flex items-center gap-2"> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path> </svg>
最后更新：2026/1/8 </span> </div> </div> </div> </div></div></div> </div> <div class="liquid-glass-container "><div class="liquidGlass-wrapper dock rounded-lg p-6 my-4"><div class="liquidGlass-effect-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-tint-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-shine  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-text intersect-no-queue  px-3 lg:px-8  intersect:animate-fadeUp transition-all duration-300 fast-slow"> <div id="tcomment" class="markdown-content"></div> <script>(function(){const twikooEnvId = "https://comment.l-pig.cn/";

  document.addEventListener("astro:page-load", () => {
    function loadTwikoo() {
      const commentsContainer = document.getElementById("tcomment");
      if (commentsContainer) {
        if (!twikooEnvId) {
          showError("留言模块未加载，Twikoo envId 未配置。");
          return;
        }
        const script = document.createElement("script");
        script.src =
          "https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.min.js";
        script.async = true;
        script.onload = () => {
          const initScript = document.createElement("script");
          initScript.innerHTML = `
            twikoo.init({
                envId: '${twikooEnvId}',
                el: '#tcomment',
            }).then(() => {
                // Twikoo 初始化完成后，动态加载自定义样式
                loadTwikooCustomStyles();
            });
            
            // 动态加载 Twikoo 自定义样式的函数
            function loadTwikooCustomStyles() {
                if (document.getElementById('twikoo-custom-link')) {
                    return;
                }
                
                const link = document.createElement('link');
                link.id = 'twikoo-custom-link';
                link.rel = 'stylesheet';
                link.href = '/src/styles/twikoo-custom.scss'; // 需要构建工具支持
                document.head.appendChild(link);
            }
        `;
          document.body.appendChild(initScript);
        };
        document.body.appendChild(script);
      }
    }

    function showError(msg){
      const list = document.getElementById("tcomment");
      if(!list) return;
      list.removeAttribute('aria-busy');
      list.innerHTML = `
        <div class="py-4">
          <div class="text-center text-red-600 dark:text-red-400">
            ${msg || "评论获取失败，请稍后重试。"}
          </div>
        </div>
      `;
      const btn = document.getElementById("rc-retry-btn");
      if(btn){ btn.addEventListener("click", load, { once: true }); }
    }
    loadTwikoo();
  });
})();</script> </div></div></div> </article> </div> <!--sidebar --> <div class="flex-col h-full sticky top-[4rem] ml-4 space-y-4 hidden lg:flex lg:w-1/4 xl:w-1/5"> <div class="liquid-glass-container "><div class="liquidGlass-wrapper dock !p-6"><div class="liquidGlass-effect-h  intersect:animate-fadeLeft transition-all duration-300 fast-slow"></div><div class="liquidGlass-tint-h  intersect:animate-fadeLeft transition-all duration-300 fast-slow"></div><div class="liquidGlass-shine  intersect:animate-fadeLeft transition-all duration-300 fast-slow"></div><div class="liquidGlass-text  intersect:animate-fadeLeft transition-all duration-300 fast-slow"><div class="intersect:animate-fadeLeft" data-astro-cid-hop3l3kc><h2 class="text-2xl border-none mb-3" data-astro-cid-hop3l3kc>内容导航</h2><div class="max-h-96 overflow-y-auto" data-astro-cid-hop3l3kc><ul class="list-none m-0 space-y-1" data-astro-cid-hop3l3kc><li class="ml-0" data-astro-cid-hop3l3kc><a href="#一什么是gmp" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>一、什么是GMP?</a></li><li class="ml-0" data-astro-cid-hop3l3kc><a href="#二gmp-模型" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>二、GMP 模型</a></li><li class="ml-0" data-astro-cid-hop3l3kc><a href="#三gmp-各自的特点" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>三、G、M、P 各自的特点：</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#ggoroutine" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>G(Goroutine)</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#mmachine" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>M(Machine)</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#pprocessor" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>P(Processor)</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#p-和-m-的创建时机" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>P 和 M 的创建时机。</a></li><li class="ml-0" data-astro-cid-hop3l3kc><a href="#四gmp调度流程" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>四、GMP调度流程</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#什么是go的调度器" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>什么是Go的调度器？</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#调度器的设计策略" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>调度器的设计策略</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#调度器的生命周期" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>调度器的生命周期</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#go-func-的调度流程" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>go func() 的调度流程</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#代码演示" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>代码演示</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#调度循环" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>调度循环</a></li><li class="ml-4" data-astro-cid-hop3l3kc><a href="#上下文切换" class="block w-full leading-relaxed no-underline hover:text-primary transition-colors duration-200 py-1" data-toc-link data-astro-cid-hop3l3kc>上下文切换</a></li></ul></div></div></div></div></div><script type="module">function u(){const t=document.querySelector("header");if(t){const e=t.offsetHeight;return console.log("Header height:",e),e+32}return 140}function g(){document.querySelectorAll("[data-toc-link]").forEach(e=>{const n=e.cloneNode(!0);e.parentNode?.replaceChild(n,e),n.addEventListener("click",function(r){r.preventDefault();const c=r.currentTarget.getAttribute("href");if(!c)return;const l=c.substring(1),o=document.getElementById(l);if(o){const s=o.getBoundingClientRect(),a=window.pageYOffset||document.documentElement.scrollTop,d=u(),i=a+s.top-d;console.log("Target element:",o),console.log("Element rect.top:",s.top),console.log("Current scroll top:",a),console.log("Header height:",d),console.log("Target scroll position:",i),window.scrollTo({top:Math.max(0,i),behavior:"smooth"}),history.pushState(null,"",`#${l}`)}})})}document.addEventListener("DOMContentLoaded",g);document.addEventListener("astro:page-load",g);</script> <!-- 推荐阅读模块 --> <div class="liquid-glass-container "><div class="liquidGlass-wrapper dock rounded-[25px] overflow-hidden mb-3"><div class="liquidGlass-effect-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-tint-h  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-shine  intersect:animate-fadeUp transition-all duration-300 fast-slow"></div><div class="liquidGlass-text intersect-no-queue intersect:animate-fadeUp transition-all duration-300 fast-slow"> <div class="py-2"> <div class="flex items-center justify-between mb-4"> <h3 class="text-lg font-bold text-txt-p dark:text-darkmode-txt-p flex items-center gap-2"> <svg class="w-5 h-5 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path> </svg>
推荐阅读
</h3> </div> <div class="space-y-1"> <div class="intersect:animate-fadeUp" style="animation-delay: 0ms"> <div class="group flex p-2 pr-4 items-center gap-3 rounded-[25px] text-txt-p
   hover:bg-orange-500 dark:hover:bg-orange-500 transition-all duration-300 
   border border-transparent hover:border-gray-200/50 dark:hover:border-gray-700/50
    [&#38;_*]:hover:text-darkmode-txt-p" data-astro-cid-tibg2hfl> <a href="/blog/go-enum" class="flex items-center gap-3 w-full no-underline" data-astro-cid-tibg2hfl> <!-- 左侧图片 --> <div class="flex-shrink-0 rounded-[18px] overflow-hidden w-14 h-14  block lg:hidden 2xl:block" data-astro-cid-tibg2hfl> <img src="/_astro/go-enum.B_idjXMN_Z2gi0vW.webp" alt="Go实现枚举 - 推荐阅读" inferSize="true" loading="lazy" fetchpriority="high" decoding="async" style="width: 64x; height: 64px;" data-astro-cid-tibg2hfl="true" width="1024" height="1024" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"> </div> <!-- 右侧内容 --> <div class="flex-1 min-w-0" data-astro-cid-tibg2hfl> <!-- 文章标题 --> <h4 class="text-txt-light dark:text-darkmode-txt-light line-clamp-2 leading-tight mb-1 text-sm" data-astro-cid-tibg2hfl> Go实现枚举 </h4> <!-- 元信息：日期和阅读时间 --> <div class="flex items-center gap-2 text-gray-500 dark:text-gray-300 text-xs" data-astro-cid-tibg2hfl> <!-- 发布日期 --> <span class="flex items-center gap-1" data-astro-cid-tibg2hfl> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-tibg2hfl> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-astro-cid-tibg2hfl></path> </svg> 2026-01-07 </span> <!-- 分隔符 --> <span class="text-gray-300 dark:text-gray-600" data-astro-cid-tibg2hfl>•</span> <!-- 阅读时间 --> <span class="flex items-center gap-1" data-astro-cid-tibg2hfl> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-tibg2hfl> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" data-astro-cid-tibg2hfl></path> </svg> 1分钟 </span> </div> </div> </a> </div>  </div><div class="intersect:animate-fadeUp" style="animation-delay: 100ms"> <div class="group flex p-2 pr-4 items-center gap-3 rounded-[25px] text-txt-p
   hover:bg-orange-500 dark:hover:bg-orange-500 transition-all duration-300 
   border border-transparent hover:border-gray-200/50 dark:hover:border-gray-700/50
    [&#38;_*]:hover:text-darkmode-txt-p" data-astro-cid-tibg2hfl> <a href="/blog/go-lib" class="flex items-center gap-3 w-full no-underline" data-astro-cid-tibg2hfl> <!-- 左侧图片 --> <div class="flex-shrink-0 rounded-[18px] overflow-hidden w-14 h-14  block lg:hidden 2xl:block" data-astro-cid-tibg2hfl> <img src="/_astro/go-lib.BGazY9pV_Z1Tj6QB.webp" alt="Go常用库 - 推荐阅读" inferSize="true" loading="lazy" fetchpriority="high" decoding="async" style="width: 64x; height: 64px;" data-astro-cid-tibg2hfl="true" width="1024" height="1024" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"> </div> <!-- 右侧内容 --> <div class="flex-1 min-w-0" data-astro-cid-tibg2hfl> <!-- 文章标题 --> <h4 class="text-txt-light dark:text-darkmode-txt-light line-clamp-2 leading-tight mb-1 text-sm" data-astro-cid-tibg2hfl> Go常用库 </h4> <!-- 元信息：日期和阅读时间 --> <div class="flex items-center gap-2 text-gray-500 dark:text-gray-300 text-xs" data-astro-cid-tibg2hfl> <!-- 发布日期 --> <span class="flex items-center gap-1" data-astro-cid-tibg2hfl> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-tibg2hfl> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-astro-cid-tibg2hfl></path> </svg> 2026-01-07 </span> <!-- 分隔符 --> <span class="text-gray-300 dark:text-gray-600" data-astro-cid-tibg2hfl>•</span> <!-- 阅读时间 --> <span class="flex items-center gap-1" data-astro-cid-tibg2hfl> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-tibg2hfl> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" data-astro-cid-tibg2hfl></path> </svg> 1分钟 </span> </div> </div> </a> </div>  </div><div class="intersect:animate-fadeUp" style="animation-delay: 200ms"> <div class="group flex p-2 pr-4 items-center gap-3 rounded-[25px] text-txt-p
   hover:bg-orange-500 dark:hover:bg-orange-500 transition-all duration-300 
   border border-transparent hover:border-gray-200/50 dark:hover:border-gray-700/50
    [&#38;_*]:hover:text-darkmode-txt-p" data-astro-cid-tibg2hfl> <a href="/blog/prefix_expr" class="flex items-center gap-3 w-full no-underline" data-astro-cid-tibg2hfl> <!-- 左侧图片 --> <div class="flex-shrink-0 rounded-[18px] overflow-hidden w-14 h-14  block lg:hidden 2xl:block" data-astro-cid-tibg2hfl> <img src="/_astro/expr.jVbyXQiQ_1IaTKP.webp" alt="中缀表达式转前缀表达式并计算 - 推荐阅读" inferSize="true" loading="lazy" fetchpriority="high" decoding="async" style="width: 64x; height: 64px;" data-astro-cid-tibg2hfl="true" width="1024" height="1024" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"> </div> <!-- 右侧内容 --> <div class="flex-1 min-w-0" data-astro-cid-tibg2hfl> <!-- 文章标题 --> <h4 class="text-txt-light dark:text-darkmode-txt-light line-clamp-2 leading-tight mb-1 text-sm" data-astro-cid-tibg2hfl> 中缀表达式转前缀表达式并计算 </h4> <!-- 元信息：日期和阅读时间 --> <div class="flex items-center gap-2 text-gray-500 dark:text-gray-300 text-xs" data-astro-cid-tibg2hfl> <!-- 发布日期 --> <span class="flex items-center gap-1" data-astro-cid-tibg2hfl> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-tibg2hfl> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-astro-cid-tibg2hfl></path> </svg> 2026-01-07 </span> <!-- 分隔符 --> <span class="text-gray-300 dark:text-gray-600" data-astro-cid-tibg2hfl>•</span> <!-- 阅读时间 --> <span class="flex items-center gap-1" data-astro-cid-tibg2hfl> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-tibg2hfl> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" data-astro-cid-tibg2hfl></path> </svg> 4分钟 </span> </div> </div> </a> </div>  </div><div class="intersect:animate-fadeUp" style="animation-delay: 300ms"> <div class="group flex p-2 pr-4 items-center gap-3 rounded-[25px] text-txt-p
   hover:bg-orange-500 dark:hover:bg-orange-500 transition-all duration-300 
   border border-transparent hover:border-gray-200/50 dark:hover:border-gray-700/50
    [&#38;_*]:hover:text-darkmode-txt-p" data-astro-cid-tibg2hfl> <a href="/blog/kafka-install" class="flex items-center gap-3 w-full no-underline" data-astro-cid-tibg2hfl> <!-- 左侧图片 --> <div class="flex-shrink-0 rounded-[18px] overflow-hidden w-14 h-14  block lg:hidden 2xl:block" data-astro-cid-tibg2hfl> <img src="/_astro/kafka.Cv9_3xsp_Z1o2vXo.webp" alt="Kafka安装、部署、测试 - 推荐阅读" inferSize="true" loading="lazy" fetchpriority="high" decoding="async" style="width: 64x; height: 64px;" data-astro-cid-tibg2hfl="true" width="512" height="256" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"> </div> <!-- 右侧内容 --> <div class="flex-1 min-w-0" data-astro-cid-tibg2hfl> <!-- 文章标题 --> <h4 class="text-txt-light dark:text-darkmode-txt-light line-clamp-2 leading-tight mb-1 text-sm" data-astro-cid-tibg2hfl> Kafka安装、部署、测试 </h4> <!-- 元信息：日期和阅读时间 --> <div class="flex items-center gap-2 text-gray-500 dark:text-gray-300 text-xs" data-astro-cid-tibg2hfl> <!-- 发布日期 --> <span class="flex items-center gap-1" data-astro-cid-tibg2hfl> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-tibg2hfl> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-astro-cid-tibg2hfl></path> </svg> 2026-01-07 </span> <!-- 分隔符 --> <span class="text-gray-300 dark:text-gray-600" data-astro-cid-tibg2hfl>•</span> <!-- 阅读时间 --> <span class="flex items-center gap-1" data-astro-cid-tibg2hfl> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-astro-cid-tibg2hfl> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" data-astro-cid-tibg2hfl></path> </svg> 5分钟 </span> </div> </div> </a> </div>  </div> </div> </div> </div></div></div> </div> </section>  </main> <footer id="main-footer" class="container px-3 lg:px-8 fixed bottom-0 left-0 right-0 z-40 pointer-events-none transition-all duration-300 fast-slow"> <div class="mx-auto py-2 md:py-4"> <!-- 整体浮动容器 --> <div class="rounded-full pointer-events-auto transition-all duration-300 fast-slow"> <nav class="liquid-glass-container "><div class="liquidGlass-wrapper px-6 py-2 rounded-full hover:bg-white/30 dark:bg-black/20 dark:hover:bg-black/50"><div class="liquidGlass-effect rounded-full intersect:animate-fadeDown transition-all duration-300 fast-slow"></div><div class="liquidGlass-tint rounded-full intersect:animate-fadeDown transition-all duration-300 fast-slow"></div><div class="liquidGlass-shine rounded-full intersect:animate-fadeDown transition-all duration-300 fast-slow"></div><div class="liquidGlass-text drop-shadow-md-white rounded-full intersect:animate-fadeDown transition-all duration-300 fast-slow"> <div class=""> <!-- 收缩状态：只显示重要信息 --> <div id="footer-collapsed" class="flex items-center justify-between md:flex-row flex-col gap-2 md:gap-0"> <!-- 左侧：版权信息 --> <div class="text-sm md:text-base text-txt-light dark:text-darkmode-txt-light text-center md:text-left">
© 2026 ·
<span class="hidden md:inline">保留所有权利 ·</span> <a href="https://blog.l-pig.cn" class="hover:text-orange-500 transition-colors">
blog.l-pig.cn ·
</a> <a href="https://beian.miit.gov.cn/#/Integrated/recordQuery" target="_blank"> 陕ICP备2020013353号-3 </a> </div> <!-- 右侧：社交链接 --> <div class="hidden md:flex md:items-center md:scale-100"> <ul class="py-2 flex items-center"><li class="inline-block px-1 intersect:animate-fade opacity-0"><a href="mailto:xiaozhu90309@gmail.com"><button id="email" type="button" class="glass-button glass-button--info glass-button--sm select-none min-w-10 justify-center " title="Email" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: #383838;--variantHoverColor: #272727;--variantShadow: rgba(99, 102, 241, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 0.75rem;--sizeFontSize: 0.875rem;--sizeIconSize: 0.875rem;--sizeGap: 0.375rem;--sizeBorderRadius: 999px;">   <span class="glass-button__content" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: #383838;--variantHoverColor: #272727;--variantShadow: rgba(99, 102, 241, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 0.75rem;--sizeFontSize: 0.875rem;--sizeIconSize: 0.875rem;--sizeGap: 0.375rem;--sizeBorderRadius: 999px;"> <span class="sr-only">Email</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="w-6 h-6  dark:hover:text-yellow-200 hover:text-yellow-200 transition duration-300" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg> </span>  </button> </a></li><li class="inline-block px-1 intersect:animate-fade opacity-0"><a href="https://github.com/L-Pig"><button id="github" type="button" class="glass-button glass-button--info glass-button--sm select-none min-w-10 justify-center " title="GitHub" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: #383838;--variantHoverColor: #272727;--variantShadow: rgba(99, 102, 241, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 0.75rem;--sizeFontSize: 0.875rem;--sizeIconSize: 0.875rem;--sizeGap: 0.375rem;--sizeBorderRadius: 999px;">   <span class="glass-button__content" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: #383838;--variantHoverColor: #272727;--variantShadow: rgba(99, 102, 241, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 0.75rem;--sizeFontSize: 0.875rem;--sizeIconSize: 0.875rem;--sizeGap: 0.375rem;--sizeBorderRadius: 999px;"> <span class="sr-only">GitHub</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="w-6 h-6  dark:hover:text-black hover:text-black transition duration-300" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </span>  </button> </a></li><li class="inline-block px-1 intersect:animate-fade opacity-0"><a href="/rss.xml"><button id="rss" type="button" class="glass-button glass-button--info glass-button--sm select-none min-w-10 justify-center " title="RSS" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: #383838;--variantHoverColor: #272727;--variantShadow: rgba(99, 102, 241, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 0.75rem;--sizeFontSize: 0.875rem;--sizeIconSize: 0.875rem;--sizeGap: 0.375rem;--sizeBorderRadius: 999px;">   <span class="glass-button__content" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: #383838;--variantHoverColor: #272727;--variantShadow: rgba(99, 102, 241, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 0.75rem;--sizeFontSize: 0.875rem;--sizeIconSize: 0.875rem;--sizeGap: 0.375rem;--sizeBorderRadius: 999px;"> <span class="sr-only">RSS</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="w-6 h-6  dark:hover:text-blue-600 hover:text-blue-600 transition duration-300" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg> </span>  </button> </a></li></ul> <!-- 返回顶部按钮 --> <button id="back-to-top-footer" type="button" class="glass-button glass-button--info glass-button--sm select-none flex items-center gap-2  py-1 text-xs md:text-sm font-medium mx-1 w-0 opacity-0 overflow-hidden pointer-events-none transition-all duration-300 ease-in-out " aria-label="返回顶部" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: #383838;--variantHoverColor: #272727;--variantShadow: rgba(99, 102, 241, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 0.75rem;--sizeFontSize: 0.875rem;--sizeIconSize: 0.875rem;--sizeGap: 0.375rem;--sizeBorderRadius: 999px;">   <span class="glass-button__content" data-astro-cid-xwnkcw7l style="--variantBase: rgb(244, 244, 244, 0.4);--variantHover: rgb(244, 244, 244, 0.6);--variantBorder: rgba(255, 255, 255, 0.8);--variantHoverBorder: rgba(255, 255, 255, 0.9);--variantColor: #383838;--variantHoverColor: #272727;--variantShadow: rgba(99, 102, 241, 0.25);--variantGradient: rgba(255, 255, 255, 0.3);--sizePadding: 0.5rem 0.75rem;--sizeFontSize: 0.875rem;--sizeIconSize: 0.875rem;--sizeGap: 0.375rem;--sizeBorderRadius: 999px;">  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path> </svg> <span>Top</span>  </span>  </button>  </div> </div> <!-- 展开状态：显示所有信息 --> <div id="footer-expanded" class="opacity-0 max-h-0 transition-all duration-300 fast-slow overflow-hidden"> <div class="z-50 flex flex-row justify-between items-center"> <!-- 导航菜单 --> <div class="hidden md:block"> <ul class="flex flex-wrap justify-center items-center gap-1 md:gap-2"> <li class="relative"> <a href="/" target="_self" class="block px-2 py-1 md:px-3 md:py-2 text-xs md:text-sm font-medium text-txt-p transition-all duration-300 dark:text-darkmode-txt-p rounded-lg relative z-10 hover:text-orange-500 hover:bg-white/10"> 首页 </a> </li><li class="relative"> <a href="/blog" target="_self" class="block px-2 py-1 md:px-3 md:py-2 text-xs md:text-sm font-medium text-txt-p transition-all duration-300 dark:text-darkmode-txt-p rounded-lg relative z-10 hover:text-orange-500 hover:bg-white/10"> 博客 </a> </li><li class="relative"> <a href="/about" target="_self" class="block px-2 py-1 md:px-3 md:py-2 text-xs md:text-sm font-medium text-txt-p transition-all duration-300 dark:text-darkmode-txt-p rounded-lg relative z-10 hover:text-orange-500 hover:bg-white/10"> 关于 </a> </li><li class="relative"> <a href="/search" target="_self" class="block px-2 py-1 md:px-3 md:py-2 text-xs md:text-sm font-medium text-txt-p transition-all duration-300 dark:text-darkmode-txt-p rounded-lg relative z-10 hover:text-orange-500 hover:bg-white/10"> 搜索 </a> </li><li class="relative"> <a href="/terms" target="_self" class="block px-2 py-1 md:px-3 md:py-2 text-xs md:text-sm font-medium text-txt-p transition-all duration-300 dark:text-darkmode-txt-p rounded-lg relative z-10 hover:text-orange-500 hover:bg-white/10"> 条款 </a> </li><li class="relative"> <a href="/links" target="_self" class="block px-2 py-1 md:px-3 md:py-2 text-xs md:text-sm font-medium text-txt-p transition-all duration-300 dark:text-darkmode-txt-p rounded-lg relative z-10 hover:text-orange-500 hover:bg-white/10"> 友链 </a> </li> </ul> </div> <!-- 统计数据和返回顶部 --> <div class="text-center hidden md:flex md:items-center md:gap-2"> <div class="flex flex-wrap items-center justify-center gap-x-1 gap-y-1 md:gap-x-2 text-xs md:text-sm text-txt-light dark:text-darkmode-txt-light"> <!-- 浏览量已取消显示 -->
·
<span>7 文章</span>
·
<span>全站 5.5K 字</span>
·
<span>运行 180 天</span> </div> </div> </div> </div> </div> </div></div></nav> </div> </div> </footer> <!-- Footer 滚动控制脚本 --> <script type="module">function c(){const t=document.getElementById("main-footer"),n=document.getElementById("footer-collapsed"),e=document.getElementById("footer-expanded");if(!t||!n||!e)return;let o=!1;function i(){const r=window.pageYOffset||document.documentElement.scrollTop,u=window.innerHeight,p=document.documentElement.scrollHeight,d=r+u>=p-50;d&&!o&&e?(e.style.opacity="1",e.style.maxHeight="200px",o=!0):!d&&o&&e&&(e.style.opacity="0",e.style.maxHeight="0",o=!1)}let l=!1;function s(){l||(requestAnimationFrame(()=>{i(),l=!1}),l=!0)}window.addEventListener("scroll",s,{passive:!0}),i()}function a(){const t=document.getElementById("back-to-top-footer");if(!t)return;t.style.padding="0";let n=!1;t.addEventListener("click",l=>{l.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})});function e(){if(!t)return;const s=(window.pageYOffset||document.documentElement.scrollTop)>300;s&&!n?(t.style.width="auto",t.style.opacity="1",t.style.padding="0.6rem",t.style.display="visible",t.style.pointerEvents="auto",n=!0):!s&&n&&(t.style.width="0",t.style.opacity="0",t.style.padding="0",t.style.display="hidden",t.style.pointerEvents="none",n=!1)}let o=!1;function i(){o||(requestAnimationFrame(()=>{e(),o=!1}),o=!0)}window.addEventListener("scroll",i,{passive:!0}),e()}document.addEventListener("DOMContentLoaded",()=>{c(),a()});document.addEventListener("astro:page-load",()=>{c(),a()});</script> <script type="module">function c(){document.querySelectorAll("pre").forEach(o=>{if(o.querySelector(".copy-code-btn"))return;o.style.position="relative";const e=document.createElement("button");e.className="copy-code-btn",e.innerHTML=`
        <span class="copy-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
          </svg>
        </span>
        <span class="copy-text">复制</span>
      `,e.addEventListener("click",async()=>{const s=o.querySelector("code"),a=s?s.innerText:o.innerText;let n=!1;try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(a),n=!0;else throw new Error("Clipboard API unavailable")}catch{try{const t=document.createElement("textarea");t.value=a,t.style.position="fixed",t.style.left="-9999px",t.style.top="0",document.body.appendChild(t),t.focus(),t.select(),n=document.execCommand("copy"),document.body.removeChild(t)}catch(t){console.error("Fallback copy failed:",t)}}if(n){const r=`
            <span class="copy-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </span>
            <span class="copy-text">复制</span>
          `;e.innerHTML='<span class="copy-text">已复制!</span>',e.classList.add("copied"),setTimeout(()=>{e.parentElement&&(e.innerHTML=r,e.classList.remove("copied"))},2e3)}else e.innerHTML='<span class="copy-text">失败</span>',setTimeout(()=>{e.parentElement&&(e.innerHTML=`
                  <span class="copy-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                  </span>
                  <span class="copy-text">复制</span>
                `)},2e3)}),o.appendChild(e)})}document.addEventListener("astro:page-load",c);document.addEventListener("DOMContentLoaded",c);</script>  <!-- <ObserverScript /> --> <!-- KaTeX 初始化脚本 --> <script type="module">let o=null;const s=["✨ 魔法正在施展中...","🌈 彩虹桥搭建中...","🎨 创意正在迸发...","🚀 即将起飞...","💫 星辰大海等你来...","🌹 精彩内容准备中...","🌟 闪亮登场倒计时...","🎪 奇妙之旅即将开始...","🎶 美妙旋律响起...","🌸 花朵正在绽放...","🦋 蝴蝶翩翩起舞...","🌙 月光洒向大地..."];function f(){return s[Math.floor(Math.random()*s.length)]}function h(){const t=document.getElementById("loading-text");t&&(t.textContent=f())}function a(t=0){o&&(clearTimeout(o),o=null);const e=document.querySelector(".page-loading");e&&(h(),t>0?requestAnimationFrame(()=>{setTimeout(()=>{e.classList.add("active")},t)}):requestAnimationFrame(()=>{e.classList.add("active")}))}function r(t=100){const e=document.querySelector(".page-loading");e&&(o=setTimeout(()=>{requestAnimationFrame(()=>{e.classList.remove("active")}),o=null},t))}function L(){return document.readyState==="complete"||document.readyState==="interactive"}document.addEventListener("astro:before-preparation",()=>{const t=L()?150:0;a(t)});document.addEventListener("astro:page-load",()=>{r()});document.addEventListener("click",t=>{const n=t.target.closest("a");if(n&&n.href){const i=new URL(n.href),d=new URL(window.location.href);if(i.origin===d.origin&&!i.hash){const c=n.hasAttribute("download")||n.href.match(/\.(pdf|doc|docx|zip|rar|exe|dmg)$/i),l=n.target==="_blank",m=n.href.startsWith("mailto:"),u=n.href.startsWith("tel:"),g=n.getAttribute("href")?.startsWith("#");!c&&!l&&!m&&!u&&!g&&i.pathname!==d.pathname&&a()}}});window.addEventListener("popstate",()=>{a()});document.addEventListener("submit",t=>{const e=t.target;e&&e.method.toLowerCase()==="get"&&a()});document.addEventListener("DOMContentLoaded",()=>{r()});document.readyState==="complete"&&r();</script> <!-- 页面跳转等待动画脚本 --> <script type="module">function e(){if(typeof window.renderMathInElement<"u"&&document.body)try{window.renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})}catch(t){console.warn("KaTeX rendering failed:",t)}}document.addEventListener("DOMContentLoaded",e);document.addEventListener("astro:page-load",e);document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e();</script> <!-- 自定义底部代码 -->  </body></html>